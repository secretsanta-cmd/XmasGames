<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Duck Asteroids ðŸ¦†</title>
  <style>
    body { margin: 0; background: #111; color: white; font-family: sans-serif; text-align: center; }
    canvas { background: #000; display: block; margin: auto; }
    #info { margin-top: 10px; }
  </style>
</head>
<body>
  <h1>Duck Asteroids ðŸ¦†</h1>
  <canvas id="game" width="600" height="600"></canvas>
  <div id="info">Score : <span id="score">0</span></div>

  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");
    const scoreEl = document.getElementById("score");

    const WIDTH = canvas.width;
    const HEIGHT = canvas.height;

    let score = 0;
    let gameOver = false;
    let speedMultiplier = 1;

    /* === SPRITES === */
    const duckImg = new Image();
    duckImg.src = "canard.png";   // Ã  placer dans le repo

    const asteroidImg = new Image();
    asteroidImg.src = "chasseur.png";

    const magretImg = new Image();
    magretImg.src = "cuisse.png";

    const duck = {
      x: WIDTH / 2,
      y: HEIGHT / 2,
      angle: 0,
      size: 42,
      speed: 3
    };

    let magrets = [];
    let asteroids = [];

    function createAsteroid() {
      const edge = Math.floor(Math.random() * 4);
      let x, y;
      if (edge === 0) { x = 0; y = Math.random() * HEIGHT; }
      if (edge === 1) { x = WIDTH; y = Math.random() * HEIGHT; }
      if (edge === 2) { x = Math.random() * WIDTH; y = 0; }
      if (edge === 3) { x = Math.random() * WIDTH; y = HEIGHT; }

      const angle = Math.random() * Math.PI * 2;
      return {
        x,
        y,
        vx: Math.cos(angle) * (1.2 + speedMultiplier),
        vy: Math.sin(angle) * (1.2 + speedMultiplier),
        size: 42
      };
    }

    function ensureAsteroids() {
      while (asteroids.length < 3) {
        asteroids.push(createAsteroid());
      }
    }

    ensureAsteroids();

    const keys = {};
    window.addEventListener("keydown", e => keys[e.key] = true);
    window.addEventListener("keyup", e => keys[e.key] = false);

    window.addEventListener("keydown", e => {
      if (e.key === " " && !gameOver) {
        magrets.push({
          x: duck.x,
          y: duck.y,
          vx: Math.cos(duck.angle) * 6,
          vy: Math.sin(duck.angle) * 6,
          life: 60
        });
      }
    });

    function update() {
      if (gameOver) return;

      if (keys["ArrowLeft"]) duck.angle -= 0.07;
      if (keys["ArrowRight"]) duck.angle += 0.07;
      if (keys["ArrowUp"]) {
        duck.x += Math.cos(duck.angle) * duck.speed;
        duck.y += Math.sin(duck.angle) * duck.speed;
      }

      duck.x = (duck.x + WIDTH) % WIDTH;
      duck.y = (duck.y + HEIGHT) % HEIGHT;

      magrets.forEach(m => {
        m.x += m.vx;
        m.y += m.vy;
        m.life--;
      });
      magrets = magrets.filter(m => m.life > 0);

      asteroids.forEach(a => {
        a.x = (a.x + a.vx + WIDTH) % WIDTH;
        a.y = (a.y + a.vy + HEIGHT) % HEIGHT;
      });

      for (let ai = asteroids.length - 1; ai >= 0; ai--) {
        for (let mi = magrets.length - 1; mi >= 0; mi--) {
          const a = asteroids[ai];
          const m = magrets[mi];
          const dx = a.x - m.x;
          const dy = a.y - m.y;
          if (Math.hypot(dx, dy) < a.size / 2) {
            asteroids.splice(ai, 1);
            magrets.splice(mi, 1);
            score++;
            scoreEl.textContent = score;

            if (score === 10) speedMultiplier = 2;
            if (score === 20) {
              gameOver = true;
              alert("Victoire ! Le canard est rassasiÃ© ðŸ¦†ðŸ¥©");
            }
            break;
          }
        }
      }

      ensureAsteroids();
    }

    function draw() {
      ctx.clearRect(0, 0, WIDTH, HEIGHT);

      // Canard
      ctx.save();
      ctx.translate(duck.x, duck.y);
      ctx.rotate(duck.angle);
      ctx.drawImage(duckImg, -duck.size / 2, -duck.size / 2, duck.size, duck.size);
      ctx.restore();

      // Magrets
      magrets.forEach(m => {
        ctx.drawImage(magretImg, m.x - 8, m.y - 8, 16, 16);
      });

      // AstÃ©roÃ¯des
      asteroids.forEach(a => {
        ctx.drawImage(asteroidImg, a.x - a.size / 2, a.y - a.size / 2, a.size, a.size);
      });
    }

    function loop() {
      update();
      draw();
      requestAnimationFrame(loop);
    }

    loop();
  </script>
</body>
</html>
