<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Duck Asteroids ðŸ¦†</title>
  <style>
    body { margin: 0; background: #111; color: white; font-family: sans-serif; text-align: center; }
    canvas { background: #000; display: block; margin: auto; }
    #info { margin-top: 10px; }
  </style>
</head>
<body>
  <h1>Gare aux chasseurs ! ðŸ¦†</h1>
  <h2>Touches en 20 pour gagner, mais ne te fais pas toucher !</h2>
  <canvas id="game" width="600" height="600"></canvas>
  <div id="info">Score : <span id="score">0</span></div>

  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");
    const scoreEl = document.getElementById("score");

    const WIDTH = canvas.width;
    const HEIGHT = canvas.height;

    let score = 0;
    let gameOver = false;
    let speedMultiplier = 1;
    let canRestart = false;

    /* === SPRITES === */
    const duckImg = new Image();
    duckImg.src = "canard.png";   // Ã  placer dans le repo

    const asteroidImg = new Image();
    asteroidImg.src = "chasseur.png";

    const magretImg = new Image();
    magretImg.src = "cuisse.png";

    const duck = {
      x: WIDTH / 2,
      y: HEIGHT / 2,
      angle: 0,
      size: 50,
      speed: 3
    };

    let magrets = [];
    let asteroids = [];

    function createAsteroid() {
      const edge = Math.floor(Math.random() * 4);
      let x, y;
      if (edge === 0) { x = 0; y = Math.random() * HEIGHT; }
      if (edge === 1) { x = WIDTH; y = Math.random() * HEIGHT; }
      if (edge === 2) { x = Math.random() * WIDTH; y = 0; }
      if (edge === 3) { x = Math.random() * WIDTH; y = HEIGHT; }

      const angle = Math.random() * Math.PI * 2;
      return {
        x,
        y,
        vx: Math.cos(angle) * (1.2 + speedMultiplier),
        vy: Math.sin(angle) * (1.2 + speedMultiplier),
        size: 32
      };
    }

    function ensureAsteroids() {
      while (asteroids.length < 3) {
        asteroids.push(createAsteroid());
      }
    }

    ensureAsteroids();

    const keys = {};
    window.addEventListener("keydown", e => keys[e.key] = true);
    window.addEventListener("keyup", e => keys[e.key] = false);

    window.addEventListener("keydown", e => {
  if (e.key === " " && !gameOver) {
    magrets.push({
      x: duck.x,
      y: duck.y,
      vx: Math.cos(duck.angle) * 6,
      vy: Math.sin(duck.angle) * 6,
      life: 60
    });
  }

  if ((e.key === "r" || e.key === "R") && canRestart) {
    restartGame();
  }
});


    function update() {
      if (gameOver) return;

      if (keys["ArrowLeft"]) duck.angle -= 0.07;
      if (keys["ArrowRight"]) duck.angle += 0.07;
      if (keys["ArrowUp"]) {
        duck.x += Math.cos(duck.angle) * duck.speed;
        duck.y += Math.sin(duck.angle) * duck.speed;
      }

      duck.x = (duck.x + WIDTH) % WIDTH;
      duck.y = (duck.y + HEIGHT) % HEIGHT;

      magrets.forEach(m => {
        m.x += m.vx;
        m.y += m.vy;
        m.life--;
      });
      magrets = magrets.filter(m => m.life > 0);

      asteroids.forEach(a => {
        a.x = (a.x + a.vx + WIDTH) % WIDTH;
        a.y = (a.y + a.vy + HEIGHT) % HEIGHT;
      });

      // Collision magret / astÃ©roÃ¯de
      for (let ai = asteroids.length - 1; ai >= 0; ai--) {
        for (let mi = magrets.length - 1; mi >= 0; mi--) {
          const a = asteroids[ai];
          const m = magrets[mi];
          if (Math.hypot(a.x - m.x, a.y - m.y) < a.size / 2) {
            asteroids.splice(ai, 1);
            magrets.splice(mi, 1);
            score++;
            scoreEl.textContent = score;

            if (score === 5) speedMultiplier = 2;
            if (score === 10) {
              gameOver = true;
              canRestart = true;
              alert("Victoire ! Le canard est rassasiÃ© ðŸ¦†ðŸ¥©\n" +
                      "Appuie sur R pour recommencer");
            }
            break;
          }
        }
      }

      // Collision canard / astÃ©roÃ¯de â†’ GAME OVER
      for (const a of asteroids) {
        if (Math.hypot(a.x - duck.x, a.y - duck.y) < (a.size + duck.size) / 2) {
          gameOver = true;
          canRestart = true;
          alert("Game Over ðŸ’¥\n" +
"Le canard a Ã©tÃ© touchÃ© !\n" + 
"Appuie sur R pour recommencer");
          return;
        }
      }

      ensureAsteroids();
    }

    function draw() {
      ctx.clearRect(0, 0, WIDTH, HEIGHT);

      // Canard
      ctx.save();
      ctx.translate(duck.x, duck.y);
      ctx.rotate(duck.angle);
      ctx.drawImage(duckImg, -duck.size / 2, -duck.size / 2, duck.size, duck.size);
      ctx.restore();

      // Magrets
      magrets.forEach(m => {
        ctx.drawImage(magretImg, m.x - 12, m.y - 12, 24, 24);
      });

      // AstÃ©roÃ¯des
      asteroids.forEach(a => {
        ctx.drawImage(asteroidImg, a.x - a.size / 2, a.y - a.size / 2, a.size, a.size);
      });
    }

    function restartGame() {
  score = 0;
  speedMultiplier = 1;
  gameOver = false;
  canRestart = false;
  scoreEl.textContent = score;

  duck.x = WIDTH / 2;
  duck.y = HEIGHT / 2;
  duck.angle = 0;

  magrets = [];
  asteroids = [];
  ensureAsteroids();

  for (const key in keys) {
    keys[key] = false;
  }
}


    function loop() {
      update();
      draw();
      requestAnimationFrame(loop);
    }

    loop();
  </script>
</body>
</html>
